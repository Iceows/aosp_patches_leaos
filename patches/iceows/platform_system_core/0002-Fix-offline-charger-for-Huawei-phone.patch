From 228889313e91b12b00562033f8ceb2268ab47d11 Mon Sep 17 00:00:00 2001
From: Raphael Mounier <mounierr07@gmail.com>
Date: Tue, 6 Dec 2022 06:35:56 +0100
Subject: [PATCH 2/3] Fix offline charger for Huawei phone

# Add ressource vendor charger init
# Add declaration of offlinecharger service
---
 rootdir/init.rc | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/rootdir/init.rc b/rootdir/init.rc
index cd71aa8aa..5385b772f 100644
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -11,6 +11,19 @@ import /vendor/etc/init/hw/init.${ro.hardware}.rc
 import /system/etc/init/hw/init.usb.configfs.rc
 import /system/etc/init/hw/init.${ro.zygote}.rc
 
+# Add vendor charger init
+import /vendor/etc/init/${ro.bootmode}/init.${ro.bootmode}.rc
+
+# Add offlinecharger service from Huawei
+service charger /system/bin/offlinecharger -p
+    class charger
+    user root
+    group root system shell graphics input wakelock
+    capabilities SYS_BOOT
+    seclabel u:r:charger:s0
+
+
+
 # Cgroups are mounted right before early-init using list from /etc/cgroups.json
 on early-init
     # Disable sysrq from keyboard
-- 
2.25.1

